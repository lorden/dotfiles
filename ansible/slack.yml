---
# tasks file for installing Slack

- name: Ensure dependencies for Slack installation are present
  become: yes
  apt:
    name:
      - curl
      - gpg # Needed for the fallback repository key handling
    state: present

# Attempt to install via direct .deb download (preferred)
- name: Download latest Slack .deb package
  become: yes
  get_url:
    url: "https://slack.com/downloads/instructions/linux?ddl=1&build=deb"
    dest: /tmp/slack.deb
    mode: '0644'
  register: download_result

- name: Install Slack from downloaded .deb
  become: yes
  apt:
    deb: /tmp/slack.deb
    state: present

